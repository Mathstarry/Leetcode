# 位运算技巧


## 左移运算 `<<`
**定义**：  
`k << i` 表示把数字 `k` 在二进制上往左位移 `i` 位，右边补 0。比如 3 的二进制为 (0011)<sub>2</sub>，`3 << 2` 可以得到 (1100)<sub>2</sub>，其十进制值为 12。

**性质**：  
1. `k << 1` 相当于把数字 `k` 乘以 2，`k << i` 相当于把数字 `k` 乘以 2<sup>*i*</sup>。



## 右移运算 `>>`
**定义**：  
`k >> i` 表示把数字 `k` 在二进制上往右位移 `i` 位，左边补 0，右边的直接去掉。比如 7 的二进制为 (0111)<sub>2</sub>，`7 >> 2` 可以得到 (0001)<sub>2</sub>，其十进制值为 1。

**性质**： 
1. `k >> 1` 相当于把数字 `k` 除以 2 并向下取整，`k >> i` 相当于把数字 `k` 除以 2<sup>*i*</sup> 并向下取整。



## 按位异或运算 `^`
**定义**：  
`a ^ b` 表示当 `a` 与 `b` 的二进制相同位上同为 `1` 或 `0` 时，结果的这一位为 `0`，否则为 `1`。

**性质**： 
1. 当 `x` 为奇数时， `x` 的二进制表示的末位为 `1`，所以我们有 `x ^ 1 = x - 1`；  
   当 `x` 为偶数时， `x` 的二进制表示的末位为 `0`，所以我们有 `x ^ 1 = x + 1`。
   
   应用见 [765. 情侣牵手 方法一](https://github.com/Mathstarry/Leetcode/blob/master/problems/0765_minSwapsCouples/ideas.md)
   
2. 结合左移 `<<` 操作。`x ^ 1` 可以改变 `x` 最后一位的奇偶性，那么 `x ^ (1 << i)` 就可以改变 `x` 从右至左第 `i` 位的奇偶性。  
   这个性质可以应用于状态压缩的题目，用于改变第 `i` 位的状态为 `0` 或 `1`。




## 按位取反运算 `~`
**定义**：  
`~k` 表示把数字 `k` 在二进制上的 `1` 全变成 `0`，`0` 全变成 `1`。

**性质**：  
1. 在状态压缩的题目中，不妨设总共有 4 个变量，总共 2<sup>4</sup> 种状态，那么状态 (0101)<sub>2</sub> 的相反状态就是 (1010)<sub>2</sub>，
   即 5 的相反状态是 10，而通过 `~5 & (2**4 - 1)` 就可以得到 10。
2. 考虑如下问题，给定状态 A，B，只有当状态A，B的某一位上值都为 0 时，新状态 C 在这一位上的值才可以为 1。  
   容易想到 `~(A | B)` 可以将A，B上同为 0 的位置全置为 1，而其余位置全置为 0 (不包括状态之外左侧A，B同为0的部分)。  
   再结合方法一，我们有 `~(A | B) & (2**k - 1)`，其中 `k` 表示所有的变量数(小于32)。  
   [例一](https://github.com/Mathstarry/Leetcode/blob/master/tricks/bit-operation/example_01.md)
   
   




## 按位取与运算 `&`
**定义**：  
`a&b` 表示当 `a` 与 `b` 的二进制相同位上同为 `1` 时，结果的这一位为 `1`，否则为 `0`。

**性质**：  
1. `k & (~k) = 0`，根据取反运算的定义，易证。
2. `k & (-k) = t`，其中 `t` 只有一位为 `1`，其余全为 `0`。  
   已知 `-k = ~k + 1`，`~k + 1` 会将 `~k` 最右侧的连续的 `1` 全部变成 `0`，而将 `~k` 最右侧的一个 `0` 变成 `1`。
   那么 `k & (-k)` 就相当于把 `k` 原本最右侧的 `1` 保留下来，其余全置为 `0`。  
   结合 `t & 1` 与 `t >> 1`，计算 `t` 右移的次数，当返回 `True` 时，便知道 `t` 最低位的 `1` 在第几位了。
   
   
   
   
   
   
